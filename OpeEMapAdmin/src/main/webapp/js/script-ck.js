var core={init:function(){self=this;Modernizr.touch&&$("#search").addClass("ipad");$(document).bind("mousemove",function(e){$(".ui-tooltip").length>0&&(e.pageX<parseInt($(".ui-tooltip").width()+5)?$(".ui-tooltip").addClass("ui-tooltip-flip"):$(".ui-tooltip").removeClass("ui-tooltip-flip"))});$(document).on("click",".modal .close",function(e){e.preventDefault();$(this).parent().fadeOut("fast",function(){$(this).remove()})});$(document).on("click",".open-help",function(e){e.preventDefault();if($(this).siblings("#currenthelp").length>0){$("#currenthelp").hide().attr("id","");return}$("#currenthelp").hide().attr("id","");var t=$(this).data("help");$(this).parent().find(".help-box").attr("id","currenthelp").toggle()});$(document).on("click","#currenthelp .close",function(e){e.preventDefault();$("#currenthelp").hide().attr("id","")});$(document).on("click",".search-results .close",function(e){e.preventDefault();$(".search-results").slideUp("fast")});$(document).on("click",".tags a",function(e){e.preventDefault();$("#search").val($(this).html().replace("#",""));$("#search").parent().submit()});$(document).on("keydown","#search",function(){$(".input-wrapper").addClass("searching")});$(document).on("keyup","#search",function(){$(".input-wrapper").removeClass("searching");$(".search-results").show();$(".search-results-title").text("").append('<span>"'+$("input[name='search']").val()+'"</span> gav 2 träffar')});$(document).on("submit","form",function(){$(".search-results").show();$(".search-results-title").text("").append('<span>"'+$("input[name='search']").val()+'"</span> gav 2 träffar')});$(document).on("click",function(e){$("#toggle-primary").removeClass("active");$(".primary").removeClass("active");$(".dd").removeClass("active");$(".submenu").hide();var t=e.target?e.target:e.srcElement,n=t.parentNode.id,r=$("#"+n).attr("id");if($("#"+r).hasClass("active")){$("#"+r).removeClass("active");$("#"+r).hasClass(".select-box")&&$("#"+r).find(".arrow").text("_");return}$(".select-box").each(function(){$(this).attr("id")!=r&&$(this).find(".arrow").text("_");$(this).removeClass("active")});if(n.substring(0,6)=="select"){$("#"+n).toggleClass("active");$("#"+n).find(".arrow").text("^")}});$(document).on("click",".dd",function(e){var t=$(this).attr("id");if($(this).parents(".primary").length==0){$("#toggle-primary").removeClass("active");$(".primary").removeClass("active");if($(this).hasClass("active")){$(this).removeClass("active");$("#sub"+t).hide();return}}$(".submenu").each(function(){$(this).attr("id")!=t&&$(this).hide().parent().removeClass("active")});if(t.substring(0,4)=="menu"){e.stopPropagation();$("#"+t).addClass("active");$("#sub"+t).show()}});$(document).on("click","#toggle-primary, .primary",function(e){e.stopPropagation();$(".dd").removeClass("active");$(".submenu").hide();$(this).toggleClass("active");$(".primary").toggleClass("active")});$(document).on("click",".options li",function(e){e.preventDefault();$(".options li").removeClass("selected");$(this).addClass("selected");$(this).parents(".select-box").find(".text:first").html($(this).find(".text").html())});$(document).on("click",".gray",function(e){e.preventDefault();$(this).removeClass("gray");self.miniModal("success",3e3,"Sparad som favorit.")});$(document).on("click","#notifications",function(e){(e.target.nodeName=="I"||e.target.nodeName=="A")&&$("#notifications").toggleClass("active")});$("input[type=text]").bind("focus blur",function(){$(".input-wrapper").toggleClass("focus")});$("i[title]").tooltip({position:{my:"right+29 bottom-22",collision:"flipfit"},track:!1,content:function(){return $(this).prop("title")+'<span class="marker"></span>'},show:{effect:"none"},hide:{effect:"none"}});$("input[title]").tooltip({position:{my:"left top-38",at:"right top",collision:"none"},track:!1,content:function(){return $(this).prop("title")+'<span class="marker"></span>'},show:{effect:"none"},hide:{effect:"none"}}).off("mouseover mouseout");$("input[title]").focus(function(){var e=$(document).find(".ui-tooltip"),t=$(this).parent().find("i").offset().left;$(e).css({left:t-e.width()+4})});$("#tabs").tabs();$("a[rel=send]").on("click",function(){$(".success").show()});$("a.logged-out").on("click",function(e){e.preventDefault();$.get("elegitimation.html",function(e){$("body").prepend(e)})});$(document).on("click",".login-box .close, .login-overlay-shadow",function(){$(".login-box").remove()});$(document).on("keyup",function(e){e.keyCode==27&&$(".login-box").remove()});$(document).on("click","#open_msg",function(e){e.preventDefault();$("#new-message").show();$("html, body").animate({scrollTop:$("#new-message").offset().top},"fast");$("#message").focus();$(this).hide()});$(document).on("click",".close_msg",function(e){e.preventDefault();$("#new-message").hide();$("#open_msg").show()});$(document).on("click","#open_note",function(e){e.preventDefault();$("#new-note").show();$("html, body").animate({scrollTop:$("#new-note").offset().top},"fast");$("#note").focus();$(this).hide()});$(document).on("click",".close_note",function(e){e.preventDefault();$("#new-note").hide();$("#open_note").show()});$(document).on("click","#save_errand",function(e){e.preventDefault();self.miniModal("success",3e3,'Ärendet sparat. Du hittar det under "Mina ärenden"')});$(document).on("click",".add-official-1 .btn",function(){$(".add-official-1").hide();$(".add-official-2").show()});$(document).on("click","#edit_favourite .delete_favourite",function(e){e.preventDefault();e.stopPropagation();var t=$(this).parents("li").find(".text").text(),n=confirm("Är du säker på att du vill ta bort: "+t);if(!n)return;$(this).parents("li").slideUp(0,function(){self.miniModal("success",3e3,"Favorit borttagen.");$(this).remove();$("#edit_favourite li").removeClass("odd");var e=1;$("#edit_favourite li").each(function(){e%2==0&&$(this).addClass("odd");e++})})});$(window).resize(function(){})},miniModal:function(e,t,n){var r=$("<div>").addClass("mini-modal "+e),i=$("<div>").addClass("inner"),s=$("<span>").text(n);i.append(s);r.append(i);r.prependTo("body");r.fadeIn("fast").delay(t).fadeOut("fast",function(){r.remove()})}};jQuery(document).ready(function(e){core.init()});